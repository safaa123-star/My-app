<!DOCTYPE html>
<html lang="ar" dir="rtl" id="html-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù†Ø§Ø³Ø®</title>
    <!-- Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØªØ¨Ø© PDF.js Ù…Ù† CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØªØ¨Ø© Tesseract.js -->
    <script src="https://unpkg.com/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
    <!-- Ø¥Ø¶Ø§ÙØ© Ø®Ø· Cairo Ù…Ù† Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
            color: #1a202c;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #ffffff;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        .logo {
            width: 200px;
            height: auto;
            margin-bottom: 10px;
        }
        .language-selector {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .language-selector select {
            padding: 8px;
            border-radius: 8px;
            border: 2px solid #3182ce;
            background: #fff;
            font-size: 1rem;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        .language-selector select:hover {
            border-color: #2b6cb0;
        }
        .upload-section {
            background: #f1f9ff;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 2px solid #e2e8f0;
            transition: border-color 0.3s ease;
        }
        .upload-section:hover {
            border-color: #3182ce;
        }
        .form-group {
            margin-bottom: 25px;
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #2d3748;
            font-size: 1.1rem;
        }
        input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: #fff;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: border-color 0.3s ease;
        }
        input[type="file"]:hover {
            border-color: #3182ce;
        }
        input[type="number"] {
            width: 100px;
            padding: 10px;
            border: 2px solid #3182ce;
            border-radius: 8px;
            font-size: 1rem;
            background: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: border-color 0.3s ease;
        }
        input[type="number"]:hover {
            border-color: #2b6cb0;
        }
        button {
            background: linear-gradient(135deg, #3182ce, #2b6cb0);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            margin: 10px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(49, 130, 206, 0.3);
        }
        button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .file-info {
            margin-top: 20px;
            padding: 20px;
            background: #edf2f7;
            border-radius: 10px;
            display: none;
            border: 1px solid #e2e8f0;
            font-size: 0.95rem;
            color: #4a5568;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 25px;
            align-items: center;
        }
        .page-copy-section {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 2px solid #bee3f8;
        }
        .page-copy-section label {
            margin: 0;
            font-size: 0.95rem;
            color: #2d3748;
        }
        .result-section {
            margin-top: 30px;
            padding: 25px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: #f7fafc;
            display: none;
        }
        .result-section h2 {
            color: #38a169;
            margin-top: 0;
            font-size: 1.5rem;
            border-bottom: 2px solid #38a169;
            padding-bottom: 10px;
        }
        #extractedText {
            white-space: pre-wrap;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            max-height: 450px;
            overflow-y: auto;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        .supported-formats {
            margin-top: 25px;
            font-size: 0.9rem;
            color: #718096;
            text-align: center;
        }
        /* ØªÙ†Ø³ÙŠÙ‚ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ */
        .copy-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #38a169;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            font-size: 1rem;
        }
        .copy-message.show {
            opacity: 1;
        }
        /* ØªÙ†Ø³ÙŠÙ‚ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ø°ÙŠØ± */
        .warning {
            color: #dd6b20;
            font-style: italic;
            margin-top: 15px;
            font-size: 0.95rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <!-- Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© ÙƒÙ„ÙˆØ¬Ùˆ -->
            <img src="https://od.lk/s/NzFfMjQ2NzQ5MDBf/e8c7c31ff283eb11cec6544269f5f9b901002ddb0224403433d1ce41316442f6.png" alt="PDF Copier Logo" class="logo">
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ© -->
            <div class="language-selector">
                <select id="languageSelect">
                    <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                    <option value="en">English</option>
                </select>
            </div>
        </div>
        
        <div class="upload-section">
            <div class="form-group">
                <label for="fileInput" id="fileInputLabel">ğŸ“ Ø§Ø®ØªØ± Ù…Ù„Ù PDF Ù„Ø±ÙØ¹Ù‡:</label>
                <input type="file" id="fileInput" accept=".pdf">
            </div>
            
            <div class="file-info" id="fileInfo">
                <strong id="fileSelectedLabel">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ø¯Ø¯:</strong> <span id="fileName"></span><br>
                <strong id="fileTypeLabel">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù:</strong> <span id="fileType"></span><br>
                <strong id="fileSizeLabel">Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù:</strong> <span id="fileSize"></span><br>
                <strong id="pageCountLabel">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª:</strong> <span id="pageCount"></span>
            </div>
            
            <div class="controls" id="controlsSection">
                <div class="page-copy-section">
                    <label for="startCopyPage" id="startCopyPageLabel">Ù†Ø³Ø® Ù…Ù† ØµÙØ­Ø©:</label>
                    <input type="number" id="startCopyPage" min="1" placeholder="Ù…Ø«Ø§Ù„: 1" disabled>
                    <label for="endCopyPage" id="endCopyPageLabel">Ø¥Ù„Ù‰ ØµÙØ­Ø©:</label>
                    <input type="number" id="endCopyPage" min="1" placeholder="Ù…Ø«Ø§Ù„: 5" disabled>
                </div>
                <button id="executeBtn" disabled>ØªÙ†ÙÙŠØ° ÙˆÙ†Ø³Ø®</button>
            </div>
        </div>
        
        <div class="supported-formats">
            <p id="supportedFormatsText">ğŸ“ Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§: PDF</p>
        </div>
        
        <div class="result-section" id="resultSection">
            <h2 id="resultSectionTitle">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ø§Ø³Ø®</h2>
            <div id="extractedText"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('fileInput');
            const executeBtn = document.getElementById('executeBtn');
            const startCopyPage = document.getElementById('startCopyPage');
            const endCopyPage = document.getElementById('endCopyPage');
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileType = document.getElementById('fileType');
            const fileSize = document.getElementById('fileSize');
            const pageCount = document.getElementById('pageCount');
            const resultSection = document.getElementById('resultSection');
            const extractedText = document.getElementById('extractedText');
            const languageSelect = document.getElementById('languageSelect');
            
            let currentFile = null;
            let totalPages = 0;

            // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù†ØµÙˆØµ Ø¨Ù„ØºØªÙŠÙ†
            const translations = {
                ar: {
                    pageTitle: 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù†Ø§Ø³Ø®',
                    fileInputLabel: 'ğŸ“ Ø§Ø®ØªØ± Ù…Ù„Ù PDF Ù„Ø±ÙØ¹Ù‡:',
                    fileSelectedLabel: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ø¯Ø¯:',
                    fileTypeLabel: 'Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù:',
                    fileSizeLabel: 'Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù:',
                    pageCountLabel: 'Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª:',
                    startCopyPageLabel: 'Ù†Ø³Ø® Ù…Ù† ØµÙØ­Ø©:',
                    startCopyPagePlaceholder: 'Ù…Ø«Ø§Ù„: 1',
                    endCopyPageLabel: 'Ø¥Ù„Ù‰ ØµÙØ­Ø©:',
                    endCopyPagePlaceholder: 'Ù…Ø«Ø§Ù„: 5',
                    executeBtn: 'ØªÙ†ÙÙŠØ° ÙˆÙ†Ø³Ø®',
                    supportedFormatsText: 'ğŸ“ Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§: PDF',
                    resultSectionTitle: 'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ø§Ø³Ø®',
                    fileDetailsTitle: 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ù',
                    extractedTextTitle: 'Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬',
                    noTextFound: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Øµ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©.',
                    failedToProcessPage: 'ÙØ´Ù„ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©.',
                    processingFile: 'Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù ÙˆØ§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ...',
                    failedToExtractText: 'ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ù…Ù„Ù PDF. Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ù„Ù ØªØ§Ù„ÙÙ‹Ø§ Ø£Ùˆ Ù…Ø­Ù…ÙŠÙ‹Ø§.',
                    copiedTextMessage: 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ',
                    failedToCopyText: 'ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ù†Øµ. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.',
                    noTextToCopy: 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†Øµ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù†Ø³Ø® ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø­Ø¯Ø¯.',
                    invalidStartPage: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØµÙØ­Ø© Ø¨Ø¯Ø§ÙŠØ© ØµØ§Ù„Ø­Ø© (Ø¨ÙŠÙ† 1 Ùˆ',
                    invalidEndPage: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØµÙØ­Ø© Ù†Ù‡Ø§ÙŠØ© ØµØ§Ù„Ø­Ø© (Ø¨ÙŠÙ† ',
                    and: 'Ùˆ',
                    onlyPDFSupported: 'ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ù…Ù„Ù PDF ÙÙ‚Ø·. Ø§Ù„ØµÙŠØº Ø§Ù„Ø£Ø®Ø±Ù‰ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§.',
                    failedToReadPages: 'ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª. Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ù„Ù ØªØ§Ù„ÙÙ‹Ø§ Ø£Ùˆ Ù…Ø­Ù…ÙŠÙ‹Ø§.',
                    failedToLoadPDFJS: 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© PDF.js. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.',
                    emptyPagesWarning: 'Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Øµ Ù…Ù†Ù‡Ø§ (Ø­ØªÙ‰ Ø¨Ø¹Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø© OCR): ',
                    bytes: 'Ø¨Ø§ÙŠØª',
                    kilobytes: 'ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª',
                    megabytes: 'Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª',
                    gigabytes: 'Ø¬ÙŠØ¬Ø§Ø¨Ø§ÙŠØª',
                },
                en: {
                    pageTitle: 'PDF Copier',
                    fileInputLabel: 'ğŸ“ Choose a PDF file to upload:',
                    fileSelectedLabel: 'Selected File:',
                    fileTypeLabel: 'File Type:',
                    fileSizeLabel: 'File Size:',
                    pageCountLabel: 'Number of Pages:',
                    startCopyPageLabel: 'Copy from page:',
                    startCopyPagePlaceholder: 'e.g., 1',
                    endCopyPageLabel: 'To page:',
                    endCopyPagePlaceholder: 'e.g., 5',
                    executeBtn: 'Execute & Copy',
                    supportedFormatsText: 'ğŸ“ Currently supported format: PDF',
                    resultSectionTitle: 'Copier Results',
                    fileDetailsTitle: 'File Details',
                    extractedTextTitle: 'Extracted Text',
                    noTextFound: 'No text found on this page.',
                    failedToProcessPage: 'Failed to process this page.',
                    processingFile: 'Processing the file and extracting text...',
                    failedToExtractText: 'Failed to extract text from the PDF file. The file might be corrupted or protected.',
                    copiedTextMessage: 'Text copied successfully',
                    failedToCopyText: 'Failed to copy text. Please try again.',
                    noTextToCopy: 'No text found to copy in the specified range.',
                    invalidStartPage: 'Please enter a valid start page (between 1 and ',
                    invalidEndPage: 'Please enter a valid end page (between ',
                    and: 'and',
                    onlyPDFSupported: 'Please upload a PDF file only. Other formats are not supported currently.',
                    failedToReadPages: 'Failed to read the number of pages. The file might be corrupted or protected.',
                    failedToLoadPDFJS: 'Failed to load PDF.js library. Please check your internet connection.',
                    emptyPagesWarning: 'Note: The following pages could not have text extracted (even after attempting OCR): ',
                    bytes: 'Bytes',
                    kilobytes: 'KB',
                    megabytes: 'MB',
                    gigabytes: 'GB',
                }
            };

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ù† localStorage Ø£Ùˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)
            let currentLang = localStorage.getItem('language') || 'ar';
            languageSelect.value = currentLang;
            applyLanguage(currentLang);

            // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©
            languageSelect.addEventListener('change', function() {
                currentLang = this.value;
                localStorage.setItem('language', currentLang);
                applyLanguage(currentLang);
            });

            // Ø¯Ø§Ù„Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ØºØ©
            function applyLanguage(lang) {
                const htmlRoot = document.getElementById('html-root');
                const pageTitle = document.getElementById('page-title');
                const fileInputLabel = document.getElementById('fileInputLabel');
                const fileSelectedLabel = document.getElementById('fileSelectedLabel');
                const fileTypeLabel = document.getElementById('fileTypeLabel');
                const fileSizeLabel = document.getElementById('fileSizeLabel');
                const pageCountLabel = document.getElementById('pageCountLabel');
                const startCopyPageLabel = document.getElementById('startCopyPageLabel');
                const startCopyPageInput = document.getElementById('startCopyPage');
                const endCopyPageLabel = document.getElementById('endCopyPageLabel');
                const endCopyPageInput = document.getElementById('endCopyPage');
                const executeBtn = document.getElementById('executeBtn');
                const supportedFormatsText = document.getElementById('supportedFormatsText');
                const resultSectionTitle = document.getElementById('resultSectionTitle');

                // ØªØºÙŠÙŠØ± Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø© ÙˆÙ„ØºØ© Ø§Ù„Ø¹Ø±Ø¶
                htmlRoot.setAttribute('lang', lang);
                htmlRoot.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');

                // ØªØºÙŠÙŠØ± Ø§Ù„Ù†ØµÙˆØµ
                pageTitle.textContent = translations[lang].pageTitle;
                fileInputLabel.textContent = translations[lang].fileInputLabel;
                fileSelectedLabel.textContent = translations[lang].fileSelectedLabel;
                fileTypeLabel.textContent = translations[lang].fileTypeLabel;
                fileSizeLabel.textContent = translations[lang].fileSizeLabel;
                pageCountLabel.textContent = translations[lang].pageCountLabel;
                startCopyPageLabel.textContent = translations[lang].startCopyPageLabel;
                startCopyPageInput.placeholder = translations[lang].startCopyPagePlaceholder;
                endCopyPageLabel.textContent = translations[lang].endCopyPageLabel;
                endCopyPageInput.placeholder = translations[lang].endCopyPagePlaceholder;
                executeBtn.textContent = translations[lang].executeBtn;
                supportedFormatsText.textContent = translations[lang].supportedFormatsText;
                resultSectionTitle.textContent = translations[lang].resultSectionTitle;
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ PDF.js
            if (typeof pdfjsLib === 'undefined') {
                alert(translations[currentLang].failedToLoadPDFJS);
                return;
            }
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

            fileInput.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    currentFile = e.target.files[0];
                    const fileExtension = currentFile.name.split('.').pop().toLowerCase();
                    
                    if (fileExtension !== 'pdf') {
                        alert(translations[currentLang].onlyPDFSupported);
                        fileInput.value = '';
                        return;
                    }
                    
                    // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„Ù
                    fileName.textContent = currentFile.name;
                    fileType.textContent = fileExtension.toUpperCase();
                    fileSize.textContent = formatFileSize(currentFile.size);
                    fileInfo.style.display = 'block';
                    
                    // ØªÙ…ÙƒÙŠÙ† Ø²Ø± Ø§Ù„ØªÙ†ÙÙŠØ° ÙˆØ­Ù‚ÙˆÙ„ Ù†Ø·Ø§Ù‚ Ø§Ù„ØµÙØ­Ø§Øª
                    executeBtn.disabled = false;
                    startCopyPage.disabled = false;
                    endCopyPage.disabled = false;
                    
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª
                    getPDFPageCount(currentFile).then(count => {
                        totalPages = count;
                        pageCount.textContent = count;
                        startCopyPage.max = count;
                        endCopyPage.max = count;
                    }).catch(err => {
                        console.error('Error getting PDF page count:', err);
                        pageCount.textContent = 'ØºÙŠØ± Ù…ØªØ§Ø­';
                        alert(translations[currentLang].failedToReadPages);
                        fileInput.value = '';
                    });
                }
            });
            
            executeBtn.addEventListener('click', async function() {
                if (!currentFile) return;
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†Ø·Ø§Ù‚ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯
                const startPage = parseInt(startCopyPage.value);
                const endPage = parseInt(endCopyPage.value);
                
                if (!startPage || startPage < 1 || startPage > totalPages) {
                    alert(`${translations[currentLang].invalidStartPage}${totalPages})`);
                    return;
                }
                if (!endPage || endPage < startPage || endPage > totalPages) {
                    alert(`${translations[currentLang].invalidEndPage}${startPage} ${translations[currentLang].and}${totalPages})`);
                    return;
                }
                
                // ØªØ¹Ø·ÙŠÙ„ Ø²Ø± Ø§Ù„ØªÙ†ÙÙŠØ° Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
                executeBtn.disabled = true;
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„
                extractedText.innerHTML = `<div style="text-align: center; padding: 20px;">${translations[currentLang].processingFile}</div>`;
                resultSection.style.display = 'block';
                
                try {
                    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ù…Ù„Ù PDF
                    const { textContent, textToCopy, emptyPages } = await extractPDFText(currentFile, startPage, endPage);
                    
                    // Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬
                    extractedText.innerHTML = `
                        <h3 style="color: #3182ce;">${translations[currentLang].fileDetailsTitle}</h3>
                        <p><strong>${translations[currentLang].fileSelectedLabel}</strong> ${currentFile.name}</p>
                        <p><strong>${translations[currentLang].fileTypeLabel}</strong> PDF</p>
                        <p><strong>${translations[currentLang].pageCountLabel}</strong> ${totalPages}</p>
                        <p><strong>${translations[currentLang].startCopyPageLabel}</strong> ${startPage} ${translations[currentLang].endCopyPageLabel} ${endPage}</p>
                        ${emptyPages.length > 0 ? `<p class="warning">${translations[currentLang].emptyPagesWarning}${emptyPages.join(', ')}</p>` : ''}
                        
                        <h3 style="color: #3182ce; margin-top: 20px;">${translations[currentLang].extractedTextTitle}</h3>
                        <div style="background: white; padding: 15px; border-radius: 5px; border: 1px solid #e2e8f0;">
                            ${textContent}
                        </div>
                    `;
                    
                    // Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©
                    if (textToCopy) {
                        navigator.clipboard.writeText(textToCopy).then(() => {
                            showCopyMessage(translations[currentLang].copiedTextMessage);
                        }).catch(err => {
                            console.error('Failed to copy text:', err);
                            alert(translations[currentLang].failedToCopyText);
                        });
                    } else {
                        alert(translations[currentLang].noTextToCopy);
                    }
                    
                    // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                    resultSection.scrollIntoView({ behavior: 'smooth' });
                } catch (err) {
                    console.error('Error extracting PDF text:', err);
                    extractedText.innerHTML = `<p style="color: red;">${translations[currentLang].failedToExtractText}</p>`;
                } finally {
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…ÙƒÙŠÙ† Ø²Ø± Ø§Ù„ØªÙ†ÙÙŠØ°
                    executeBtn.disabled = false;
                }
            });
            
            // Ø¯Ø§Ù„Ø© Ù„ØªÙ†Ø³ÙŠÙ‚ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù
            function formatFileSize(bytes) {
                if (bytes === 0) return `0 ${translations[currentLang].bytes}`;
                const k = 1024;
                const sizes = [
                    translations[currentLang].bytes,
                    translations[currentLang].kilobytes,
                    translations[currentLang].megabytes,
                    translations[currentLang].gigabytes
                ];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            // Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† Ù…Ù„Ù PDF
            async function getPDFPageCount(file) {
                const fileReader = new FileReader();
                return new Promise((resolve, reject) => {
                    fileReader.onload = async function() {
                        try {
                            const typedArray = new Uint8Array(this.result);
                            const pdf = await pdfjsLib.getDocument({ data: typedArray }).promise;
                            resolve(pdf.numPages);
                        } catch (err) {
                            reject(err);
                        }
                    };
                    fileReader.onerror = () => reject(new Error('Failed to read the file'));
                    fileReader.readAsArrayBuffer(file);
                });
            }
            
            // Ø¯Ø§Ù„Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† Ù…Ù„Ù PDF Ù…Ø¹ Ø¯Ø¹Ù… OCR
            async function extractPDFText(file, startPage, endPage) {
                const fileReader = new FileReader();
                return new Promise((resolve, reject) => {
                    fileReader.onload = async function() {
                        try {
                            const typedArray = new Uint8Array(this.result);
                            const pdf = await pdfjsLib.getDocument({ data: typedArray }).promise;
                            let textContent = '';
                            let textToCopy = '';
                            let emptyPages = [];
                            
                            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙØ­Ø§Øª ØµÙØ­Ø© Ø¨ØµÙØ­Ø© Ø¨Ø´ÙƒÙ„ Ù…ØªØ³Ù„Ø³Ù„
                            for (let i = startPage; i <= endPage; i++) {
                                console.log(`Processing page ${i}...`);
                                try {
                                    const page = await pdf.getPage(i);
                                    let pageText = '';
                                    
                                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø©
                                    const text = await page.getTextContent();
                                    pageText = text.items.map(item => item.str).join(' ').trim();
                                    
                                    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù†ØµØŒ Ø¬Ø±Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… OCR
                                    if (!pageText) {
                                        console.log(`Page ${i} has no extractable text. Attempting OCR...`);
                                        try {
                                            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØµÙØ­Ø© ÙƒØµÙˆØ±Ø© (Canvas)
                                            const viewport = page.getViewport({ scale: 1.0 });
                                            const canvas = document.createElement('canvas');
                                            const context = canvas.getContext('2d');
                                            canvas.height = viewport.height;
                                            canvas.width = viewport.width;
                                            await page.render({
                                                canvasContext: context,
                                                viewport: viewport
                                            }).promise;
                                            
                                            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ Ù†Øµ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Tesseract.js
                                            const { data: { text } } = await Tesseract.recognize(canvas, currentLang, {
                                                logger: m => console.log(`OCR progress for page ${i}: ${m.status} (${Math.round(m.progress * 100)}%)`)
                                            });
                                            pageText = text.trim();
                                            console.log(`OCR result for page ${i}: ${pageText ? 'Text extracted' : 'No text found'}`);
                                            
                                            if (!pageText) {
                                                emptyPages.push(i);
                                            }
                                        } catch (ocrErr) {
                                            console.error(`OCR failed for page ${i}:`, ocrErr);
                                            emptyPages.push(i);
                                        }
                                    }
                                    
                                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ù…Ù†Ø³ÙˆØ®
                                    textContent += `
                                        <div class="page-content" data-page="${i}">
                                            <strong>${translations[currentLang].startCopyPageLabel.replace(':', '')} ${i}:</strong><br>
                                            ${pageText || translations[currentLang].noTextFound}<br><br>
                                        </div>
                                    `;
                                    if (pageText) {
                                        textToCopy += pageText + '\n\n';
                                    }
                                } catch (pageErr) {
                                    console.error(`Failed to process page ${i}:`, pageErr);
                                    emptyPages.push(i);
                                    textContent += `
                                        <div class="page-content" data-page="${i}">
                                            <strong>${translations[currentLang].startCopyPageLabel.replace(':', '')} ${i}:</strong><br>
                                            ${translations[currentLang].failedToProcessPage}<br><br>
                                        </div>
                                    `;
                                }
                            }
                            
                            resolve({ textContent, textToCopy: textToCopy.trim(), emptyPages });
                        } catch (err) {
                            reject(err);
                        }
                    };
                    fileReader.onerror = () => reject(new Error('Failed to read the file'));
                    fileReader.readAsArrayBuffer(file);
                });
            }
            
            // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯
            function showCopyMessage(message) {
                const messageElement = document.createElement('div');
                messageElement.className = 'copy-message';
                messageElement.textContent = message;
                document.body.appendChild(messageElement);
                
                setTimeout(() => {
                    messageElement.classList.add('show');
                }, 100);
                
                setTimeout(() => {
                    messageElement.classList.remove('show');
                    setTimeout(() => {
                        messageElement.remove();
                    }, 500);
                }, 3000);
            }
        });
    </script>
</body>
</html>